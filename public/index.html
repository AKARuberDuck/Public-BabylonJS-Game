<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>BabylonJS Game</title>
  <style>
    html, body { margin: 0; overflow: hidden; width: 100%; height: 100%; }
    #renderCanvas { width: 100%; height: 100%; touch-action: none; }
    #hud, #scoreboard, #nameOverlay {
      position: absolute;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 10px;
      border-radius: 5px;
      font-size: 18px;
      z-index: 5;
    }
    #hud { top: 10px; left: 10px; line-height: 1.5em; }
    #scoreboard { top: 10px; right: 10px; display: none; }
    #nameOverlay {
      top: 0; left: 0; width: 100%; height: 100%;
      display: flex; align-items: center; justify-content: center;
      flex-direction: column; background: black; font-size: 20px;
    }
    body::after {
      content: ''; position: absolute; width: 100%; height: 100%;
      pointer-events: none;
      background: repeating-linear-gradient(
        to bottom, rgba(255,255,255,0.03),
        rgba(255,255,255,0.03) 1px, transparent 1px, transparent 2px);
      z-index: 1000;
    }
  </style>
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/cannon.js"></script>
</head>
<body>
  <div id="nameOverlay">
    <h2>Enter Your Name</h2>
    <input type="text" id="playerNameInput" placeholder="Player" style="padding: 8px; font-size: 18px;">
    <label style="margin-top: 10px;">
      Game Time:
      <input type="number" id="gameTime" value="30" style="width: 60px; font-size: 16px;">
    </label>
    <button onclick="startGame()" style="margin-top:10px; font-size:18px;">Start Game</button>
  </div>

  <div id="hud">
    <div><strong>Score:</strong> <span id="score">0</span></div>
    <div><strong>Time:</strong> <span id="time">30</span>s</div>
    <div><strong>Players:</strong> <span id="players">1</span></div>
  </div>

  <div id="scoreboard">
    <strong>üèÜ Final Score:</strong> <span id="finalScore"></span>
  </div>

  <canvas id="renderCanvas"></canvas>

  <script>
    let playerName = "Player", timeLeft = 30;

    function startGame() {
      playerName = document.getElementById("playerNameInput").value.trim() || "Player";
      timeLeft = parseInt(document.getElementById("gameTime").value) || 30;
      document.getElementById("nameOverlay").style.display = "none";
      initGame(){
        function spawnHazard() {
  const enemy = BABYLON.MeshBuilder.CreateBox("enemy", { size: 1 }, scene);
  enemy.position = new BABYLON.Vector3(Math.random() * 14 - 7, 0.5, Math.random() * 14 - 7);
  enemy.material = new BABYLON.StandardMaterial("enemyMat", scene);
  enemy.material.diffuseColor = new BABYLON.Color3(1, 0, 0);

  const dir = new BABYLON.Vector3(Math.random() - 0.5, 0, Math.random() - 0.5).normalize().scale(0.1);

  scene.onBeforeRenderObservable.add(() => {
    enemy.position.addInPlace(dir);
    if (BABYLON.Vector3.Distance(enemy.position, player.position) < 1.1) {
      score = Math.max(0, score - 1);
      scoreText.textContent = score;
    }
  });
}
setInterval(spawnHazard, 7000);

      };
    }

    function initGame() {
      const canvas = document.getElementById("renderCanvas");
      const engine = new BABYLON.Engine(canvas, true);
      const scene = new BABYLON.Scene(engine);

      const camera = new BABYLON.ArcRotateCamera("cam", Math.PI / 2, Math.PI / 3, 15, BABYLON.Vector3.Zero(), scene);
      camera.attachControl(canvas, true);
      const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(1, 1, 0), scene);
      scene.enablePhysics(new BABYLON.Vector3(0, -9.8, 0), new BABYLON.CannonJSPlugin());

      // Dynamic lighting
      scene.registerBeforeRender(() => {
        const t = performance.now() / 5000;
        const i = Math.abs(Math.sin(t));
        light.intensity = 0.3 + i * 0.7;
        scene.clearColor = new BABYLON.Color4(0.2 + i * 0.5, 0.4 + i * 0.5, 0.6 + i * 0.3, 1);
      });

      // Ground
      const ground = BABYLON.MeshBuilder.CreateGroundFromHeightMap("ground", "", {
        width: 20, height: 20, subdivisions: 50, minHeight: 0, maxHeight: 2,
        onReady: () => {
          ground.physicsImpostor = new BABYLON.PhysicsImpostor(
            ground, BABYLON.PhysicsImpostor.HeightmapImpostor, { mass: 0 }, scene
          );
        }
      }, scene);
      const groundMat = new BABYLON.StandardMaterial("groundMat", scene);
      groundMat.diffuseColor = new BABYLON.Color3(0.3, 0.6, 0.3);
      ground.material = groundMat;

      // Player sphere
      const player = BABYLON.MeshBuilder.CreateSphere("player", { diameter: 1 }, scene);
      player.position = new BABYLON.Vector3(0, 2, 0);
      player.material = new BABYLON.StandardMaterial("playerMat", scene);
      player.material.diffuseColor = new BABYLON.Color3(0.2, 0.6, 1);
      player.physicsImpostor = new BABYLON.PhysicsImpostor(player, BABYLON.PhysicsImpostor.SphereImpostor, {
        mass: 1, friction: 0.6, restitution: 0.4
      }, scene);
      camera.lockedTarget = player;

      // Score and time display
      let score = 0;
      const scoreText = document.getElementById("score");
      const timeText = document.getElementById("time");
      const playersText = document.getElementById("players");
      const scoreboard = document.getElementById("scoreboard");
      const finalScoreText = document.getElementById("finalScore");

      // Arrow key movement
      const keys = {};
      window.addEventListener("keydown", (e) => keys[e.code] = true);
      window.addEventListener("keyup", (e) => keys[e.code] = false);
      scene.onBeforeRenderObservable.add(() => {
        const impulse = new BABYLON.Vector3(
          (keys["ArrowRight"] ? 1 : 0) - (keys["ArrowLeft"] ? 1 : 0),
          0,
          (keys["ArrowDown"] ? 1 : 0) - (keys["ArrowUp"] ? 1 : 0)
        ).normalize().scale(1.5);
        if (impulse.length() > 0) {
          player.physicsImpostor.applyImpulse(impulse, player.getAbsolutePosition());
        }
      });

      // Collectibles
      function spawnCollectible() {
        const orb = BABYLON.MeshBuilder.CreateSphere("collectible", { diameter: 0.5 }, scene);
        orb.position = new BABYLON.Vector3(Math.random() * 14 - 7, 0.5, Math.random() * 14 - 7);
        orb.material = new BABYLON.StandardMaterial("mat", scene);
        orb.material.diffuseColor = new BABYLON.Color3(1, 1, 0);
        orb.actionManager = new BABYLON.ActionManager(scene);
        scene.onBeforeRenderObservable.add(() => {
          if (BABYLON.Vector3.Distance(orb.position, player.position) < 1) {
            score++; scoreText.textContent = score;
            orb.dispose();
          }
        });
      }
      setInterval(spawnCollectible, 3000);

      // Hazards
      function spawnHazard() {
        const enemy = BABYLON.MeshBuilder.CreateBox("enemy", { size: 1 }, scene);
        enemy.position = new BABYLON.Vector3(Math.random() * 14 - 7, 0.5, Math.random() * 14 - 7);
        enemy.material = new BABYLON.StandardMaterial("enemyMat", scene);
        enemy.material.diffuseColor = new BABYLON.Color3(1, 0, 0);
        const dir = new BABYLON.Vector3(Math.random() - 0.5, 0, Math.random() - 0.5).normalize().scale(0.1);
        scene.onBeforeRenderObservable.add
